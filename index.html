<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>ë“œë˜ê·¸ ê°€ëŠ¥í•œ íˆ¬ë‘ë¦¬ìŠ¤íŠ¸</title>
		<!-- LESS ìŠ¤íƒ€ì¼ -->
		<link rel="stylesheet/less" type="text/css" href="css/style.less" />
		<script src="https://cdn.jsdelivr.net/npm/less@4"></script>
		<!-- Supabase JS -->
		<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	</head>

	<body>
		<script>
			// ì¸ì¦ ìƒíƒœ í™•ì¸ í›„, ë¡œê·¸ì¸ ì•ˆ ë˜ì–´ ìˆìœ¼ë©´ login.htmlë¡œ ì´ë™, ì´í›„ ëª¨ë“  JS ë™ì  ë¡œë“œ
			(async function () {
				function loadScript(src) {
					return new Promise((resolve, reject) => {
						const s = document.createElement('script');
						s.src = src;
						s.onload = resolve;
						s.onerror = reject;
						document.body.appendChild(s);
					});
				}
				if (!window.supabase) {
					await new Promise((r) => {
						const check = setInterval(() => {
							if (window.supabase) {
								clearInterval(check);
								r();
							}
						}, 50);
					});
				}
				const supabaseJs = window.supabase;
				const SUPABASE_URL = 'https://aewnnwhiruatlkvtnwtb.supabase.co';
				const SUPABASE_ANON_KEY =
					'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFld25ud2hpcnVhdGxrdnRud3RiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4NjQ4MTgsImV4cCI6MjA3ODQ0MDgxOH0.LPnV7cdCMLqzy1B4hHM02Nv-LXSQyJla4V6x9iQaTIA';
				const client = supabaseJs.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
				const {
					data: { session },
				} = await client.auth.getSession();
				if (!session) {
					window.location.href = 'login.html';
					return;
				}
				// ìˆœì°¨ì ìœ¼ë¡œ scriptë¥¼ ë¡œë“œí•˜ì—¬ dependency ì¶©ëŒ/ì‹¤í–‰ìˆœì„œ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
				for (const jsFile of ['js/supabase.js', 'js/state.js', 'js/todo.js', 'js/calendar.js', 'js/drag.js', 'js/modal.js', 'js/dashboard.js', 'js/sidebar.js', 'js/main.js']) {
					await loadScript(jsFile);
				}
			})();
		</script>

		<!-- ì•± ì„¹ì…˜ -->
		<div id="appSection" class="app-section" style="display: none">
			<!-- ì‚¬ì´ë“œë°” -->
			<nav class="sidebar">
				<div class="sidebar-menu">
					<button class="sidebar-item active" data-view="dashboard" title="ëŒ€ì‹œë³´ë“œ">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<rect x="3" y="3" width="7" height="7"></rect>
							<rect x="14" y="3" width="7" height="7"></rect>
							<rect x="14" y="14" width="7" height="7"></rect>
							<rect x="3" y="14" width="7" height="7"></rect>
						</svg>
					</button>
					<button class="sidebar-item" data-view="todos" title="í• ì¼ ëª©ë¡">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
							<polyline points="14 2 14 8 20 8"></polyline>
							<line x1="16" y1="13" x2="8" y2="13"></line>
							<line x1="16" y1="17" x2="8" y2="17"></line>
							<polyline points="10 9 9 9 8 9"></polyline>
						</svg>
					</button>
					<button class="sidebar-item" data-view="calendar" title="ìº˜ë¦°ë”">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
							<line x1="16" y1="2" x2="16" y2="6"></line>
							<line x1="8" y1="2" x2="8" y2="6"></line>
							<line x1="3" y1="10" x2="21" y2="10"></line>
						</svg>
					</button>
					<button class="sidebar-item" data-view="completed" title="ì™„ë£Œëœ í• ì¼">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
							<polyline points="14 2 14 8 20 8"></polyline>
							<polyline points="9 15 11 17 15 13"></polyline>
						</svg>
					</button>
				</div>
				<div class="sidebar-bottom">
					<button class="sidebar-item" id="sidebarSettings" title="ì„¤ì •">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<circle cx="12" cy="12" r="3"></circle>
							<path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
						</svg>
					</button>
					<button class="sidebar-item" id="sidebarLogout" title="ë¡œê·¸ì•„ì›ƒ">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
							<polyline points="16 17 21 12 16 7"></polyline>
							<line x1="21" y1="12" x2="9" y2="12"></line>
						</svg>
					</button>
				</div>
			</nav>

			<div class="container">
				<!-- ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ -->
				<section class="section dashboard-section">
					<div class="dashboard-header">
						<h1>ëŒ€ì‹œë³´ë“œ</h1>
					</div>

					<!-- í†µê³„ ì¹´ë“œ -->
					<div class="stats-grid">
						<div class="stat-card">
							<div class="stat-icon" style="color: #667eea">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<circle cx="12" cy="12" r="10"></circle>
									<polyline points="12 6 12 12 16 14"></polyline>
								</svg>
							</div>
							<div class="stat-content">
								<div class="stat-value" id="statActive">0</div>
								<div class="stat-label">ì§„í–‰ì¤‘ì¸ í• ì¼</div>
							</div>
						</div>

						<div class="stat-card">
							<div class="stat-icon" style="color: #f093fb">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
									<polyline points="22 4 12 14.01 9 11.01"></polyline>
								</svg>
							</div>
							<div class="stat-content">
								<div class="stat-value" id="statCompleted">0</div>
								<div class="stat-label">ì™„ë£Œëœ í• ì¼</div>
							</div>
						</div>

						<div class="stat-card">
							<div class="stat-icon" style="color: #4facfe">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
									<line x1="16" y1="2" x2="16" y2="6"></line>
									<line x1="8" y1="2" x2="8" y2="6"></line>
									<line x1="3" y1="10" x2="21" y2="10"></line>
								</svg>
							</div>
							<div class="stat-content">
								<div class="stat-value" id="statScheduled">0</div>
								<div class="stat-label">ì˜ˆì •ëœ í• ì¼</div>
							</div>
						</div>

						<div class="stat-card">
							<div class="stat-icon" style="color: #43e97b">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<line x1="12" y1="1" x2="12" y2="23"></line>
									<path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
								</svg>
							</div>
							<div class="stat-content">
								<div class="stat-value" id="statCompletionRate">0%</div>
								<div class="stat-label">ì™„ë£Œìœ¨</div>
							</div>
						</div>
					</div>

					<!-- ìµœê·¼ í™œë™ -->
					<div class="dashboard-content">
						<div class="dashboard-card">
							<h3>ğŸ“… ì´ë²ˆ ì£¼ ì˜ˆì •</h3>
							<div id="weeklySchedule" class="weekly-schedule"></div>
						</div>

						<div class="dashboard-card">
							<h3>ğŸ¯ ìµœê·¼ ì™„ë£Œ</h3>
							<div id="recentCompleted" class="recent-list"></div>
						</div>
					</div>
				</section>

				<!-- ì„¹ì…˜ 1: í• ì¼ ëª©ë¡ -->
				<section class="section todo-section" style="display: none">
					<h2>í• ì¼ ëª©ë¡</h2>
					<div class="tabs">
						<button class="tab-btn active" data-tab="active">ì§„í–‰ì¤‘</button>
						<button class="tab-btn" data-tab="completed">ì™„ë£Œ</button>
					</div>
					<button id="addTodoBtn" class="add-todo-btn">+ ìƒˆ í• ì¼ ì¶”ê°€</button>
					<div id="todoList" class="todo-list drop-zone"></div>
				</section>

				<!-- ì„¹ì…˜ 2: ìº˜ë¦°ë” -->
				<section class="section calendar-section" style="display: none">
					<h2>ìº˜ë¦°ë”</h2>
					<div class="calendar-controls">
						<div class="calendar-header">
							<button id="prevPeriod">&lt;</button>
							<h3 id="currentPeriod"></h3>
							<button id="nextPeriod">&gt;</button>
						</div>
						<div class="view-switcher">
							<button class="view-btn active" data-view="calendar">ìº˜ë¦°ë”</button>
							<button class="view-btn" data-view="list">ë¦¬ìŠ¤íŠ¸</button>
						</div>
					</div>
					<div id="calendar" class="calendar"></div>
				</section>
			</div>

			<!-- í• ì¼ ì¶”ê°€ ëª¨ë‹¬ -->
			<div id="addModal" class="modal">
				<div class="modal-content">
					<span class="close-add">&times;</span>
					<h2>ìƒˆ í• ì¼ ì¶”ê°€</h2>
					<div class="modal-body">
						<div class="modal-form">
							<label>ì œëª©</label>
							<input type="text" id="newTodoTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" />
							<label>ë‚´ìš©</label>
							<textarea id="newTodoContent" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)" rows="5"></textarea>
							<div class="modal-color-picker">
								<label>ìƒ‰ìƒ</label>
								<div class="color-options">
									<div class="color-option" data-color="#667eea" style="background: #667eea"></div>
									<div class="color-option" data-color="#f093fb" style="background: #f093fb"></div>
									<div class="color-option" data-color="#4facfe" style="background: #4facfe"></div>
									<div class="color-option" data-color="#43e97b" style="background: #43e97b"></div>
									<div class="color-option" data-color="#fa709a" style="background: #fa709a"></div>
									<div class="color-option" data-color="#feca57" style="background: #feca57"></div>
									<div class="color-option" data-color="#ff6b6b" style="background: #ff6b6b"></div>
									<div class="color-option active" data-color="#a8a8a8" style="background: #a8a8a8"></div>
								</div>
							</div>
							<div class="modal-buttons">
								<button id="createTodoBtn" class="save-btn">ì¶”ê°€</button>
								<button id="cancelAddBtn" class="cancel-btn">ì·¨ì†Œ</button>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- í• ì¼ ìˆ˜ì • ëª¨ë‹¬ -->
			<div id="editModal" class="modal">
				<div class="modal-content">
					<span class="close-edit">&times;</span>
					<div class="modal-body"></div>
				</div>
			</div>
		</div>
	</body>
</html>
